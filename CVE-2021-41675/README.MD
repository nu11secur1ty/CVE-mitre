## [CVE-2021-41675](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41675)

## [Vendor](https://www.sourcecodester.com/php/12684/young-entrepreneur-e-negosyo-system.html)

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-41675/docs/Screenshot%202021-11-21%20104148-info.png)

## Author and redevelopment of the PoC

- `nu11secur1ty`

## First cool ;) Idea: 

- Thank you, dear friend!
- `Janik Wehrli`

## Description:

A Remote Code Execution (RCE) vulnerability exists in Sourcecodester E-Negosyo System 1.0 in /admin/produts/controller.php via the do Insert function, which validates images with getImageSizei...
More about the function: https://www.php.net/manual/en/function.getimagesize.php 
The attacker can deploy malicious RCE files bypassing this function, and after that, he can use the directory traversal method, to navigate to the `/uploaded_photos/`
the directory which is another and actual problem of this system. After the problem, which is - no sanitizing of the function "(getimagesize())" on this system, the attacker can execute the malicious RCE code, and then he can retrieve all sensitive information about the App on this server, and all architecture of this server. 
CONCLUSION: There is no proper disinfection of "(getimagesize())" function, and correctly protecting the directory `/uploaded_photos/`.

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-mitre/edit/main/CVE-2021-41675)

## Proof and exploit:
[href](https://streamable.com/yvg897)
