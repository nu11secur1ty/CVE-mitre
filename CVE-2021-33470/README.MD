## CVE-2021-33470

- Installation and testing on local ENV `192.168.1.x`
- Platform: `XAMPP`, `PHP` and `MySQL`
-------------------------------------------------------------
- stupid in `login.php` 
```php
if(isset($_POST['login']))
  {
    $uname=$_POST['username'];
    $Password=md5($_POST['inputpwd']);
    $query=mysqli_query($con,"select ID from tbladmin where  AdminuserName='$uname' && Password='$Password' ");
    $ret=mysqli_fetch_array($query);
    if($ret>0){
      $_SESSION['aid']=$ret['ID'];
     header('location:dashboard.php');
    }
```
- Proof: 
![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-33470/CVE-2021-33470.gif)

## Working... to FIX this shit:

- Example of simple =) fix, but not `STRONG` ;) or you can write your own `function()` in `login.php` =)
```php
if(isset($_POST['login']))
  {
    $uname=$_POST['username'];
    $Password=md5($_POST['inputpwd']);
    $query = mysqli_query($con,("select ID from tbladmin where AdminuserName=(('$uname')) && Password=(('$Password'))" ));
    $ret = mysqli_fetch_array($query);
    if($ret>0){
      $_SESSION['aid']=$ret['ID'];
     header('location:dashboard.php');
    }
 ```

![](https://github.com/nu11secur1ty/CVE-mitre/blob/main/CVE-2021-33470/CVE-2021-33470-simple-fix.gif)

## CONCLUSION:
- `NOTE:` Write a new login form by using the correct police and more strong logic!

[more:](https://github.com/nu11secur1ty/phpsecloginform)

THE PRICE OF THE FIX IS `4000$` =)
## =) BR
